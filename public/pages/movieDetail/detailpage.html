<!DOCTYPE html>
<html>

<head>
    <title>Detail-BestMovies</title>
    <link rel="stylesheet" href="../../static/webhfive/news/lib/weui.min.css">
    <link rel="stylesheet" href="../../static/webhfive/news/css/jquery-weui.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/lib/common.css" />
    <link rel="stylesheet" type="text/css" href="../../static/iconfont/iconfont.css" />
    <link rel="stylesheet" type="text/css" href="../../static/webhfive/news/css/bootstrap.css" />
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Smooch&display=swap');
    </style>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"></link>

    <link rel="stylesheet" href="../frontpage/frontpage.css" />
    <link rel="stylesheet" href="detailpage.css" />
</head>

<body ontouchstart>
    <div class="page__bd" id="app">
        <div class="header">
            <div class="left_header">
                <div class="logo_container">
                    <h1 class="title">Best<span>Movies</span></h1>
                </div>

                <ul class="navigation">
                    <a>
                        <li v-if="!isLogin" @click="clickLoginBTN">Login</li>
                        <li v-if="isLogin">{{username}}</li>
                    </a>
                    <a>
                        <li v-if="!isLogin" @click="clickSignUp ">SignUp</li>
                        <li v-if="isLogin" @click="clickFavourite">Favourite List</li>
                    </a>
                </ul>
            </div>

        </div>
        <div class="boxContainer">
            <table class="elementContainer">
                <tr>
                    <td>
                        <input v-model="searchText" type="text" placeholder="Search" class="search">
                    </td>
                    <td>
                        <a href="#" @click="clickSearchBTN"><i class="material-icons">search</i></a>
                    </td>
                </tr>
            </table>
        </div>
        <!-- login  -->
        <div v-show="clickLogin" class="center">
            <h1>Login</h1>
            <div @click="clickCloseBTN" class="close">
                <i class="fas fa-times"></i>
            </div>

            <form method="post">
                <div class="txt_field">
                    <input v-model="userId" type="text" required>
                    <span></span>
                    <label>UserID</label>
                </div>
                <div class="txt_field">
                    <input v-model="password" type="password" required>
                    <span></span>
                    <label>Password</label>
                </div>
                <a class="pass" href="https://www.youtube.com/watch?v=dQw4w9WgXcQ&ab_channel=RickAstley">Forget Password?</a>
                <input type="submit" value="Login">
                <div class="signup_link">
                    Not a member?<a @click="clickSignUp">Signup</a>
                </div>
            </form>
        </div>
        <!-- sign up  -->
        <div v-show="clickSignup" class="center">
            <h1>SignUp</h1>
            <div @click="clickCloseBTN" class="close">
                <i class="fas fa-times"></i>
            </div>

            <form method="post">
                <div class="txt_field">
                    <input v-model="userId" type="text" required>
                    <span></span>
                    <label>UserID</label>
                </div>
                <div class="txt_field">
                    <input v-model="username" type="text" required>
                    <span></span>
                    <label>UserName</label>
                </div>
                <div class="txt_field">
                    <input v-model="password" type="password" required>
                    <span></span>
                    <label>Password</label>
                </div>
                <!-- <div class="pass">Forget Password?</div> -->
                <input type="submit" value="SignUp">
                <p></p>
            </form>
        </div>
        <!-- detail  -->
        <div class="movieTitle">
            <div class="movieName">
                <h1>{{movie.name}} <span>({{movie.year}})</span></h1>
            </div>
            <div class="rate">
                <h1>Rating:
                    <span>{{movie.rating}}<b>/10</b></span>
                </h1>
                <h2>Your Rating is</h2>
            </div>

        </div>
        <div class="detailContainer">
            <div class="image">

                <img v-bind:src="movie.img">
            </div>
            <div class="wordContainer">
                <div class="people">
                    <div class="directorContainer">
                        <span>Director: </span>
                        <a v-for="name in directors">{{name.name}}</a>

                    </div>
                    <div class="directorContainer">
                        <span>Stars: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                        <a v-for="name in stars" @click="clickPeople(name.id)">{{name.name}}</a>


                    </div>

                </div>
                <div class="intro">
                    <p>{{movie.plot}}</p>

                </div>
            </div>


        </div>
        <div>Comment</div>
    </div>
</body>
<script src="https://kit.fontawesome.com/ba5c0a07f3.js" crossorigin="anonymous"></script>
<script src="../../static/js/echarts.min.js"></script>
<script src="../../static/js/jquery-2.1.4.js"></script>
<script src="../../static/webhfive/news/js/jquery-weui.js "></script>
<script src="../../static/js/vue.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<script src="../../static/js/network.js"></script>
<script>
    var data = {
        clickLogin: false,
        clickSignup: false,
        isLogin: false,
        userId: '',
        password: '',
        username: '',
        searchText: '',
        movieID: 0,
        movie: {
            id: 2872732,
            name: ' ',
            year: 0,
            rating: 7.5,
            // plot: "It was supposed to be a simple job. All Lucy had to do was deliver a mysterious briefcase to Mr. Jang. But immediately Lucy is caught up in a nightmarish deal where she is captured and turned into a drug mule for a new and powerful synthetic drug. When the bag she is carrying inside of her stomach leaks, Lucy's body undergoes unimaginable changes that begins to unlock her mind's full potential. With her new-found powers, Lucy turns into a merciless warrior intent on getting back at her captors. She receives invaluable help from Professor Norman, the leading authority on the human mind, and French police captain Pierre Del Rio.",
            img: "https://imdb-api.com/images/original/MV5BODcxMzY3ODY1NF5BMl5BanBnXkFtZTgwNzg1NDY4MTE@._V1_Ratio0.6791_AL_.jpg",
        },
        directors: [{
                id: 108,
                name: 'Luc Besson',
                birth: 1959
            }

        ],
        stars: [{
            id: 424060,
            name: 'Scarlett Johansson',
            birth: '1984'
        }, {
            id: 151,
            name: 'Morgan Freeman',
            birth: 1937
        }]

    }
    var vue = new Vue({
        el: "#app",
        data: data,
        mounted: function() {
            this.getUrlData()
            var params = document.cookie;
            var pa = params.split("&");
            var s = new Object();
            for (var i = 0; i < pa.length; i++) {
                s[pa[i].split(":")[0]] = pa[i].split(":")[1];
            }
            console.log("!!!!!", s.username, s.userid, s.isLogin)
                // getMoviePosterImg(this.movieID)
                // this.chart_movieRate()
        },
        methods: {
            clickLoginBTN() {
                this.clickSignup = false;
                this.clickLogin = true;

            },
            clickSignUp() {
                this.clickLogin = false;
                this.clickSignup = true;

            },
            clickCloseBTN() {
                this.clickLogin = false;
                this.clickSignup = false
            },
            clickSearchBTN() {
                let url = "../searchResult/searchResult.html?" + "SearchMovie=" + this.searchText;
                location.href = url;
            },
            clickPeople(peopleId) {
                console.log("CLICK", peopleId)
                let url = "../people/people.html?" + "PeopleId=" + peopleId;
                location.href = url;
            },
            getUrlData() {
                var url = location.search; //这一条语句获取了包括问号开始到参数的最后，不包括前面的路径
                var params = url.substr(1); //去掉问号
                var pa = params.split("&");
                var s = new Object();
                console.log(location)
                for (var i = 0; i < pa.length; i++) {
                    s[pa[i].split("=")[0]] = unescape(pa[i].split("=")[1]);
                }

                this.movieID = s.MovieId;
                console.log(this.movieID)
                let moviedata = getMoviePosterImg(s.MovieId);
                this.movie.plot = moviedata.plot;
                this.movie.img = moviedata.image;
                this.movie.name = moviedata.title;
                this.directors = moviedata.directorList;
                this.stars = moviedata.starList;
                this.movie.year = moviedata.year;
                // console.log(this.searchText)

            }
        }
    });
</script>

</html>